<app-redirect-hp></app-redirect-hp>

<main class="fade-in py-5 bg-soft-gray">
      <div class="container container-narrow">
        
        <div class="form-header text-center mb-5">
          <h1 class="display-6 fw-bold text-navy">Formulario de Cierre de Caso</h1>
          <p class="text-muted lead">Documentación final de resolución y conformidad del proceso QRSS.</p>
          
          <div class="project-info-top mt-4 p-3 rounded-3 bg-white shadow-sm border animate-up">
             <h6 class="text-accent fw-bold small mb-1">PROYECTO (P180349)</h6>
             <p class="mb-0 text-navy fw-medium">
               Apoyo al Fortalecimiento del Sistema Nacional de Salud de la República Dominicana
             </p>
          </div>
        </div>

        <form (ngSubmit)="onSubmit()" #cierreForm="ngForm" class="modern-form">
          
          <!-- SECCIÓN: Datos de Control -->
          <div class="form-card mb-4 shadow-sm animate-up">
            <h4 class="card-title"><i class="bi bi-file-earmark-check me-2"></i>Información de Control</h4>
            <hr class="mb-4 opacity-10">
            
            <div class="row g-4">
              <div class="col-md-6">
                <label class="form-label-modern">Unidad Ejecutora:</label>
                <select name="Unidad-Ejecutora" class="form-select-modern" [(ngModel)]="formsData.Unidad_Ejecutora">
                  <option value="" disabled selected>Seleccione unidad...</option>
                  <option value="MISPAS">MISPAS</option>
                  <option value="MIVHED">MIVHED</option>
                </select>
              </div>
              
              <div class="col-md-6">
                <label class="form-label-modern">Fecha de Respuesta:</label>
                <input type="date" name="fecha" class="form-control-modern" [(ngModel)]="formsData.fecha">
              </div>
            </div>
          </div>

          <!-- SECCIÓN I: Datos Personales -->
          <div class="form-card mb-4 shadow-sm animate-up">
            <h4 class="card-title"><i class="bi bi-person-badge me-2"></i>I. Datos Personales</h4>
            <hr class="mb-4 opacity-10">

            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label-modern">Nombre:</label>
                <input name="nombre" type="text" class="form-control-modern" placeholder="Nombres" [(ngModel)]="formsData.nombre">
              </div>
              <div class="col-md-6">
                <label class="form-label-modern">Apellido:</label>
                <input name="apellido" type="text" class="form-control-modern" placeholder="Apellidos" [(ngModel)]="formsData.apellido">
              </div>
              <div class="col-md-8">
                <label class="form-label-modern">Domicilio:</label>
                <input name="domicilio" type="text" class="form-control-modern" placeholder="Dirección completa" [(ngModel)]="formsData.domicilio">
              </div>
              <div class="col-md-4">
                <label class="form-label-modern">Distrito:</label>
                <input name="distrito" type="text" class="form-control-modern" placeholder="Distrito municipal" [(ngModel)]="formsData.distrito">
              </div>
            </div>
          </div>

          <!-- SECCIÓN II & III: Descripción y Resolución -->
          <div class="form-card mb-4 shadow-sm animate-up">
            <h4 class="card-title"><i class="bi bi-card-text me-2"></i>II. Descripción y III. Resolución</h4>
            <hr class="mb-4 opacity-10">

            <div class="mb-4">
              <label class="form-label-modern">Descripción general del caso:</label>
              <textarea name="descripcion" rows="4" class="form-control-modern" placeholder="Resumen del caso reportado..." [(ngModel)]="formsData.descripcioGeneral"></textarea>
            </div>

            <div class="mb-0">
              <label class="form-label-modern">Resumen de la resolución y medidas propuestas:</label>
              <textarea name="resolucion" rows="4" class="form-control-modern" placeholder="Detalle de la solución aplicada..." [(ngModel)]="formsData.resolucion"></textarea>
            </div>
          </div>

          <!-- SECCIÓN IV: Aceptación -->
          <div class="form-card mb-4 shadow-sm animate-up">
            <h4 class="card-title"><i class="bi bi-shield-check me-2"></i>IV. Aceptación de la Resolución</h4>
            <hr class="mb-4 opacity-10">

            <div class="bg-light p-4 rounded-3 mb-4">
              <label class="form-label-modern mb-3">Estado de la conformidad:</label>
              
              <div class="d-flex flex-column gap-3">
                <label class="radio-container">
                  <input type="radio" name="aceptacion" value="Acepto" [(ngModel)]="formsData.aceptacion_status">
                  <span class="radio-checkmark"></span> 
                  <div>
                    <span class="fw-bold d-block text-success">Acepto la resolución</span>
                    <span class="small text-muted">Acepto las medidas propuestas y el cierre definitivo del caso.</span>
                  </div>
                </label>

                <label class="radio-container">
                  <input type="radio" name="aceptacion" value="No Acepto" [(ngModel)]="formsData.aceptacion_status">
                  <span class="radio-checkmark"></span>
                  <div>
                    <span class="fw-bold d-block text-danger">No acepto</span>
                    <span class="small text-muted">Solicito formalmente el inicio de un proceso de apelación.</span>
                  </div>
                </label>
              </div>
            </div>

            <div class="row g-4 mt-2">
              <div class="col-md-12">
                <h6 class="text-navy fw-bold mb-3 border-bottom pb-2">Firmas y Responsables</h6>
              </div>
              
              <!-- Responsable -->
              <div class="col-md-6 p-3 border rounded-3 bg-white">
                <p class="small text-accent fw-bold text-uppercase mb-3">Responsable de Atención</p>
                <div class="mb-3">
                  <label class="small text-muted mb-1">Nombre Completo:</label>
                  <input name="nombreresponsable" type="text" class="form-control-modern py-2" [(ngModel)]="formsData.nombreresponsable">
                </div>
                <div class="mb-3">
                  <label class="small text-muted mb-1">Cargo:</label>
                  <input name="cargoresponsable" type="text" class="form-control-modern py-2" [(ngModel)]="formsData.cargorespnsable">
                </div>
                <div>
                  <label class="small text-muted mb-1">Firma (Digital/Nombre):</label>
                  <input name="firmaresponsable" type="text" class="form-control-modern py-2 signature-font" [(ngModel)]="formsData.firmaresponsable">
                </div>
              </div>

              <!-- Parte Interesada -->
              <div class="col-md-6 p-3 border rounded-3 bg-white">
                <p class="small text-accent fw-bold text-uppercase mb-3">Parte Interesada</p>
                <div class="mb-3">
                  <label class="small text-muted mb-1">Nombre de la Parte Interesada:</label>
                  <input name="nombreinteresado" type="text" class="form-control-modern py-2" [(ngModel)]="formsData.nombreinteresado">
                </div>
                <div class="mb-3">
                  <label class="small text-muted mb-1">Cargo (Si aplica):</label>
                  <input name="cargointeresado" type="text" class="form-control-modern py-2" [(ngModel)]="formsData.cargointeresado">
                </div>
                <div>
                  <label class="small text-muted mb-1">Firma:</label>
                  <input name="firmainteresado" type="text" class="form-control-modern py-2 signature-font" [(ngModel)]="formsData.firmainteresado">
                </div>
              </div>
            </div>
          </div>

          <!-- BOTÓN DE GUARDADO -->
          <div class="text-center mb-5">
            <button type="submit" class="btn-submit-modern w-100 py-3 shadow">
              <i class="bi bi-check-circle-fill me-2"></i>
              Guardar y Finalizar Cierre de Caso
            </button>
          </div>

        </form>
      </div>
    </main>